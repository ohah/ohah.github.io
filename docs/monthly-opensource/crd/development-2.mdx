---
title: 3-2. 배민 백로그까지 구현
description: 배민이 언급한 백로그 항목 구현
---

# 3-2. 배민 백로그까지 구현

기본 기능은 다 구현했는데, 백로그에 적혀 있던 항목들도 어느정도 싹 뚫고 싶었다. 그것도 기본 기능보다 난이도는 낮은 편이어서. 배민 블로그에서 백로그 부분만 따로 정리해두고 그 순서대로 가기로.

---

## Redux DevTools 패널

배민이 "Redux DevTools도 같이 쓰고 싶더라"라고 말한 부분은 나도 그랬다. 리덕스로 상태 관리를 하면 디버깅이 귀찮은데, 그걸 DevTools 내에서 해결한다는 건 기획자의 눈에도 쓸만할 것 같다.

그래서 Redux DevTools Extension을 CDP로 구현하기 시작했다. 사실상 리덕스 디버깅 툴을 내장시키는 거다.

### 구상

CDP 프로토콜을 이용해서 리덕스가 보내는 Action과 State 변화를 받아내고, 이미 잘 만들어진 Redux DevTools Extension을 UI로 활용하기로 했다.

1. CDP `Runtime.evaluate`로 리덕스 store 객체에 접근
2. `dispatch` 함수 자체를 감시해서 Action 발생을 추적
3. Action, State, Time stamp 같은 정보를 CDP 이벤트로 보내기
4. Inspector에서 Redux DevTools Extension처럼 UI로 표시

처음에는 Store에서 직접 감시하는 게 나을까 하다가, 결국은 브라우저 개발툴처럼 CDP 메시지로 데이터를 넘기는 방식으로 결정했다.

### 구현한 것

- ReduxExtensionBridge: CDP 메시지 버퍼링과 리덕스에 대한 포워딩 담당
- Redux.message 이벤트 리스너: INIT/ACTION/STATE 같은 이벤트 핸들링
- @redux-devtools/app을 사용해서 기존 Redux DevTools Extension과 똑같은 UI 제공

실제로는 Dispatcher, Action, State, Time, Diff까지 보여주는 기능까지 다 넣었다. 디버깅할 때 굉장히 편하고, 기존 리덕스 개발자들 입장에서도 익숙한 UI라 적응도 빠르다.

### 어려웠던 점

리덕스 스토어 객체에 접근하는 게 쉽지 않았다.
- 리덕스 패키지 구조가 바뀌기도 하고
- 리덕스 미들웨어 같은 걸 쓰면 스토어 구조가 더 복잡해짐

결국에는 Redux Toolkit 기준으로, DevTools라는 걸 전역에 심어버리는 전략으로 해결했다. Redux Toolkit을 쓰지 않는 프로젝트에서는 DevTools Polyfill이 필요해서 별도 패키지(@ohah/chrome-remote-devtools-inspector-react-native)에서 처리.

---

## MMKV / AsyncStorage 보드

리덕스 DevTools 패널이 리덕스 관점에서만 디버깅이 가능하고, 실제 저장소의 보드는 아니라서, React Native에서 MMKV·AsyncStorage로 쓰는 데이터도 보고 싶어졌다.

MMKV은 카카오페이 기술 블로그에서도 소개된 것 치고는 아직 개선할 부분이 많다. AsyncStorage도 똑같. 그래서 이런 저런 스토리지를 DevTools에서 보고 바로 수정할 수 있는 패널을 만들기로.

### 구현한 것

- MMKV DevTools 패널: MMKV key-value 쌍을 보고 수정하기
- AsyncStorage DevTools 패널: localStorage처럼 보고 수정하기
- 양쪽 다 CDP Runtime Domain을 이용해서 데이터 읽고 쓰기

코드는 단순했지만 사용성이 좋았고. 뭐, 당시는 지금처럼 지원하는 스토리지가 하나도 없어서 뻗지 않으려고 최대한 단순하게 디자인했다.

### 사용성 측면에서 아쉬운 점

- 보드 UI가 둥글둥글하게 디자인되는 게 아니라 일단 동작하는 것에 집중해서 깔끔한 UI를 못 만들었다
- MMKV은 key-value 구조라 UI가 쉬웠지만, AsyncStorage는 나중에 모듈화 과정에서 구조가 좀 더 복잡해지는 것 같음
- 스토리지 전용 보드는 DevTools에서 켤 때마다 새로 만들어야 하니까 리소스가 생각보다 많이 낭비

---

## 백로그 정리

배민이 백로그로 적어둔 항목들 중 기본 기능으로 안 건들었던 것들 싹 처리했더니, 이제 Redux DevTools와 스토리지 보드까지 다 있게 되었다.

기술적으로 말하면 CDP를 완전히 꽉 채우는 과정이라, 나중에 새로운 기능을 추가하기도 쉬워졌다.

:::info 1줄 요약
백로그에 적혀 있던 Redux DevTools 패널, MMKV/AsyncStorage 보드 등을 모두 구현했다. Redux DevTools Extension UI와 CDP 프로토콜을 결합해서 리덕스 상태 디버깅을 DevTools 내에서 완전히 끝내는 것을 목표로 했다.
:::
