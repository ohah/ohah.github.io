---
title: 3-1. 배민 구현 따라하기
description: 배민 기술 블로그에서 소개한 구현 범위 따라하기
---

# 3-1. 배민 구현 따라하기

## 배민의 철학 따라하기

처음 배민 기술 블로그를 읽고 "아, 이렇게 하는 거인가" 하면서 시작했다. 저장했다가 나중에 DevTools UI에 넘겨서 재현하는 방식, 기록방 URL 하나로 당시 Console·Network·DOM을 다시 보는 흐름이 핵심이었으니까.

나도 일단은 이것저것 다 빼고, "배민이 한 거 다 하면 될 거 아니야?" 하는 식으로 접근했다.

## 3-tier 구조로 생각하기

구조는 생각보다 단순했지만, 구현하기 전에 구조를 한 번 떠올려두니까 나중에 더 수월했다.

```
[웹페이지] ←→ [WebSocket 서버] ←→ [Inspector (브라우저)]
```

- 웹페이지에 CDP 클라이언트를 달고
- 서버는 WebSocket으로 양쪽과 통신하는 relay
- UI에서는 서버를 열고 클라이언트 선택 → CDP 메시지 타고 개발툴처럼 쓰기

이 구조대로만 하면 끝이라고 생각했다. 근데 현실은 그렇지 않더라.

## 기본 기능 구현 순서

나눈 게 기본 CDP 구현이었다.

### 1. CDP 클라이언트 만들기

웹페이지에서 실행할 클라이언트가 필요했다.

- 타크와 CDP 프로토콜 이해가 필요했고
- 타우리(Tauri) 대신 웹에서 돌아가는 클라이언트를 만들었다

최소한 필요한 것들:
- WebSocket 연결 → 서버에 붙기
- CDP 메시지 패킷 나누기 (Command ID ↔ Event ID)
- 이벤트 받아서 localStorage에 저장해두기 (다시 보려고)

### 2. 서버가 Relay만 하면 됨

서버는 복잡하지 않다.

- WebSocket 연결을 두 개 받는다
- 클라이언트에서 온 CDP 메시지는 Inspector로 넘기고
- Inspector에서 보낸 메시지는 클라이언트로 넘기기만 하면 끝

나처럼 채팅방 relay 서버 코드를 보면서 쓱 새겼다. 실질적으로는 거기서 CDP 부분만 채운 거다.

### 3. UI에서 쓰려고 하다가 엄청난 고통

"서버만 열면 다 되겠지?"라고 생각했는데, UI가 생각보다 많더라.

- 클라이언트 목록 띄우기
- 클라이언트 선택해서 연결하기
- 탭 전환: Console·Network·Application
- 콘솔에 직접 코드 입력하고 실행하기

배민은 여기서도 훌륭한 레퍼런스였다. 기획부터 디자인까지 다 아주 잘 만들어져 있어서 나는 "우리도 이거처럼 하자" 하면서 그대로 베꼈다.

:::info 1줄 요약
배민의 CDP 저장·재생 방식을 따라 3-tier 구조로 시작했다. 기본 CDP 클라이언트·WebSocket relay 서버·Inspector UI 구현까지, 겉보다 복잡한 부분을 하나하나 따라가면서 빡빡한 시간을 보냈다.
:::
